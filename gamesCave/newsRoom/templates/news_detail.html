{% extends 'base.html' %} 
{% load static %} 
{% block title %}
News Details
{% endblock title %} 
{% block content %}
{% with comments.count as total_comments %}
{% if messages %}
    {% for message in messages %}
        <span class='alert alert-danger error' id="error">Bład formularza : {{ message }}</span>
    {% endfor %}
{% endif %}
<section class="news-details">
	<div class="container">
		<div class="row">
			<div class="col-md-8 offset-md-2">
				<div class="news-card">
					<h2 class="news-title">{{ news.title }}</h2>
					<img
						src="{{ news.image.url }}"
						alt="{{ news.title }}"
						class="news-image"
					/>
					<div class="news-meta">
						<p class="news-author">Author: {{ news.author }}</p>
						<p class="news-date">Published: {{ news.publish }}</p>
					</div>
					<p class="news-body">{{ news.body }}</p>
					<div class="news-tags">
						<h4 class="tags-title">Tags:</h4>
						<div class="tags-container">
							{% for tag in news.tags.all %}
							<span class="tag">{{ tag.name }}</span>
							{% endfor %}
						</div>
						<div class="d-flex justify-content-between">
							<div class="m-1">
								<a href="."><button class=" btn btn-info">Komentarze: {{total_comments}} </button></a>
							</div>
							<div class="m-1">
								<a href="."><button class=" btn"><i class="fa-solid fa-heart fa-2xl" style="color: #c0c0c0;"></i></button></a>
							</div>
							{% if user.is_staff %}
							<div class="m-1">
								<a href="{%url 'news_delete' pk=news.id %}"><button class=" btn btn-danger">Usuń</button></a>
							</div>
							<div class="m-1">
								<a href="{%url 'news_update' pk=news.id %}"><button class=" btn btn-warning">Edytuj</button></a>
							</div>
							{% endif %}
						</div>
					</div>
					<form action="{% url 'news_detail' slug=news.slug id=news.id%}" method="POST" enctype="multipart/form-data">
						<h3 class="comment-heading text-white mt-5 mb-4">Nowy komentarz: </h3>
						<div class="row m-2 align-items-center">
						  <div class="col-md-2 text-center">
							<div class="d-flex align-items-center justify-content-center square-image-container">
							  <img class="square-image profile-photo mb-3" src="{{ user.profile.photo.url }}" alt="">
							</div>
						  </div>
						  <div class="col-md-10">
							<div class="d-flex align-items-center">
							  <textarea  class="form-control mb-3 centered-textarea" name="body" id="id_body" placeholder="Twój komentarz"></textarea>
							</div>
						  </div>
						</div>
						<div class="news-tags">
							{% csrf_token %}
							<div class ='d-flex justify-content-between'></div>
						  <button type="submit" class="btn btn-primary">Wyślij</button>
						</div>
					  </form>

					  <!-- Komentarz -->
					  <h3 class="comment-heading text-white mt-5 mb-4">Komentarze {{total_comments}} : </h3>
					  

					  <!-- 1 komentarz  -->
					  {% for comment in comments %}
					  <div class="row m-2 align-items-center">
						<div class="col-md-2 text-center">
						  <div class="d-flex align-items-center justify-content-center square-image-container">
							<img class="square-image profile-photo mb-4" src="{{comment.author.photo.url }}" alt="">
						  </div>
						</div>
						<div class="col-md-9">
						  <div class="d-flex align-items-center">
							<span class="form-control mb-4 centered-textarea comment" id="message" >{{comment.body}}</span>
						  </div>
						</div>
						<div class="col-md-1 mb-4">
							<button class=" btn bg-transparent"> <i class="fa-solid fa-pen-fancy fa-xl" style="color: #c0c0c0;"></i></button>
							<button class=" btn bg-transparent"> <i class="fa-solid fa-trash fa-xl" style="color: #ff0000;"></i> </button>
							<button class="btn bg-transparent"> <i class="fa-solid fa-skull-crossbones fa-xl" style="color: #ff8000;"></i></button>
						</div>
					  </div>
					  {% endfor %}
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
{% endwith %}
<script src="{% static 'games/JS/main.js' %}"></script>
{% endblock content %}
